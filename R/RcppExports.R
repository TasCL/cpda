# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Retrieve Empirical and Modelled Decision Times
#'
#' Get decision times for two-accumulator LBA model
#'
#' @param data a Rcpp List for subject data
#' @param pVec a Rcpp NumvericVector for parameter vector
#' @param setting a named numeric vector storing DE and MCMC parameters:
#' sigma_exact, bandwidth, ns (nsample), nmc, nchain, rp (DE noise,
#' usually .001), burnin, nthin, start (usually 1), gammaMult (DE gamma,
#' usually 2.38), ST (piecewise LBA switch time, depending on experimental
#' design), and report
#' @return A four-element list with estimated decision time for accumulator 1,
#' accumultor 2, empirical decision time for accumualtor 1 and accumulator 2.
#' @export
#' @examples
#' data(lba)
#' dMat <- data.matrix(d)
#'
#' ##  A       muv1    muw1    muv2    muw2    t_delay t_ND    b
#' p.vector <- c(A=1.51, muv1=3.32, muw1=1.51, muv2=2.24, muw2=3.69,
#'               t_delay=0.31, t_ND=0.08, b=2.7)
#' setting <- c(sigma_exact=1, bandwidth=.02, ns=1e2, nmc=30, nchain=24,
#'              rp=.001, burnin=10, nthin=3, start=1, gammaMult=2.38,
#'              ST=attr(d, "SwitchTime"), report=100)
#'
#' DTs <- pda::rplba(dMat, p.vector, setting)
#' str(DTs)
#'
#' ## List of 4
#' ## $ eDT1: num [1:72, 1] 0.317 0.425 0.71 0.345 0.526 ...
#' ## $ eDT2: num [1:28, 1] 0.45 0.418 0.56 0.719 0.313 ...
#' ## $ DT1 : num [1:695, 1] 0.488 0.801 0.376 0.507 0.532 ...
#' ## $ DT2 : num [1:305, 1] 0.538 0.77 0.568 0.271 0.881 ...
rplba <- function(data, pVec, setting) {
    .Call('pda_rplba', PACKAGE = 'pda', data, pVec, setting)
}

#' Compute Log-likelihood Using KDE-based Fast Fourier Transform
#'
#' This function implements Holmes's (2015) KDE-FFT method to calculate
#' approximated probability density. The precision is set at 10 (ie 2^10).
#' Please use \code{logLik_fft2}, if you want also the PDF, grid centers, and
#' PDF_hist outputs.
#'
#' @param y a vector storing empirical data (e.g., RTs)
#' @param yhat a vector storing simulated data (e.g., simualted RTs, using a
#' LBA model).
#' @param m minimal value extracted from the empirical data vector
#' @param M max value extracted from the empirical data vector
#' @param h KDE bandwidth
#' @param ns number of simulate data
#' @return Log-likelihood
#' @references Holmes, W. (2015). A practical guide to the Probability Density
#' Approximation (PDA) with improved implementation and error characterization.
#' \emph{Journal of Mathematical Psychology}, \bold{68-69}, 13--24,
#' doi: http://dx.doi.org/10.1016/j.jmp.2015.08.006.
#' @export
#' @examples
#' ## Use piecewise LBA data as an example
#' data(lba)
#' bandwidth <- .02;
#' nsample <- 1e4
#' m <- min(c(plba$DT1, plba$DT2)) - 3 * bandwidth
#' M <- max(c(plba$DT1, plba$DT2)) + 3 * bandwidth
#' logLik_fft(plba$DT1, plba$eDT1, m, M, bandwidth, nsample)
#' logLik_fft(plba$DT2, plba$eDT2, m, M, bandwidth, nsample)
#' tmp1 <- logLik_fft2(plba$DT1, plba$eDT1, m, M, bandwidth, nsample)
#' tmp2 <- logLik_fft2(plba$DT2, plba$eDT2, m, M, bandwidth, nsample)
#' str(tmp1)
#'
#' ## List of 4
#' ## $ LL      : num 33.9
#' ## $ PDF     : num [1:695, 1] 1.761 0.445 1.368 1.681 1.542 ...
#' ## $ z       : num [1:1024, 1] 0.157 0.159 0.16 0.161 0.162 ...
#' ## $ PDF_hist: num [1:1025, 1] 0 0 0 0 0 0 0 0 0 0 ...
#' str(tmp2)
#' ## List of 4
#' ## $ LL      : num -323
#' ## $ PDF     : num [1:305, 1] 0.5526 0.2489 0.5588 0.0579 0.3016 ...
#' ## $ z       : num [1:1024, 1] 0.157 0.159 0.16 0.161 0.162 ...
#' ## $ PDF_hist: num [1:1025, 1] 0 0 0 0 0 0 0 0 0 0 ...
logLik_fft <- function(y, yhat, m, M, h, ns) {
    .Call('pda_logLik_fft', PACKAGE = 'pda', y, yhat, m, M, h, ns)
}

#' @rdname logLik_fft
#' @export
logLik_fft2 <- function(y, yhat, m, M, h, ns) {
    .Call('pda_logLik_fft2', PACKAGE = 'pda', y, yhat, m, M, h, ns)
}

#' Compute FFT Log-likelihood for a Gaussian Distribution
#'
#' This is a wrapper function to approximate a Gaussian distribution, using
#' KDE-FFT method. To retrieve more outputs and replicate Holmes's example 1,
#' please use \code{logLik_norm2}.
#'
#' @param object a vector storing empirical data
#' @param pVec parameter vector storing mean and standard deviation
#' @param setting MCMC and DE-MC parameters
#' @return Log-likelihood; plus PDF, grid centers, and PDF_hist
#' @export
#' @examples
#' pVec <- c(mu=5, sigma=1)
#' y    <- sort(rnorm(1000, pVec[1], pVec[2]))
#' iqr  <- IQR(y, type=1)
#' S    <- sd(y)
#'
#' setting <- c(sigma_exact=1, bandwidth=.9*min(iqr,S)*1e4^(-.2), ns=1e4,
#'              nmc=30, nchain=24, rp=.001, burnin=10, nthin=3, start=1,
#'              gammaMult=2.38, ST=0, report=100)
#'
#' ll <- logLik_norm2(y, pVec, setting)
#' str(ll)
#' ## List of 4
#' ## $ LL      : num -1370
#' ## $ PDF     : num [1:1000, 1] 0.006 0.00617 0.00813 0.02605 0.03 ...
#' ## $ z       : num [1:1024, 1] 1.65 1.66 1.66 1.67 1.68 ...
#' ## $ PDF_hist: num [1:1025, 1] 0 0 0 0 0 0 0 0 0 0 ...
#'
#' end1 <- length(ll$PDF_hist)-1
#' plot(ll$z, ll$PDF_hist[1:end1], type="l", lty=2,
#' main="Normal Distribution",xlab="x",ylab="L(x|beta)")
#' lines(y, ll$PDF, col="red", lwd = 1.5)
#'
#' ##########################################################################
#'
#' logLik_norm(y, pVec, setting)
#' ## [1] -1372.969
logLik_norm <- function(object, pVec, setting) {
    .Call('pda_logLik_norm', PACKAGE = 'pda', object, pVec, setting)
}

#' @rdname logLik_norm
#' @export
logLik_norm2 <- function(object, pVec, setting) {
    .Call('pda_logLik_norm2', PACKAGE = 'pda', object, pVec, setting)
}

