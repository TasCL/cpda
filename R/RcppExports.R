# This file was generated by Rcpp::compileAttributes
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Switch Model's Prior Distributions
#'
#' This Rcpp function computes the prior for the given parameter set. The
#' prior for each parameter here is just a uniform distribution for
#' simplicity.
#'
#' @param pVec a parameter vector. Similar to DMC's p.vector
#' @return a prior probability density summed across parameters
#' @import Rcpp
#' @export
#' @examples
#' p.vector <- c(1.51, 3.32, 1.51, 2.24, 3.69, 0.31, 0.08)
#' SwitchModelPrior(pVec=p.vector)
#' require(rbenchmark)
#' within(benchmark(R=SwitchModel_Prior(p.vector),
#'                  Cpp=SwitchModelPrior(p.vector),
#'                  replications=rep(1e4, 3),
#'                  columns=c('test', 'replications', 'elapsed'),
#'                  order=c('test', 'replications')),
#'                  { average = elapsed/replications })
#' #   test replications elapsed  average
#' # 2  Cpp        10000   0.048 4.80e-06
#' # 4  Cpp        10000   0.032 3.20e-06
#' # 6  Cpp        10000   0.056 5.60e-06
#' # 1    R        10000   0.151 1.51e-05
#' # 3    R        10000   0.182 1.82e-05
#' # 5    R        10000   0.142 1.42e-05
SwitchModelPrior <- function(pVec) {
    .Call('pda_SwitchModelPrior', PACKAGE = 'pda', pVec)
}

#' Initialize a DMC Sample
#'
#' This functions initializes the initial conditions and various data structures
#' for the MCMC, using C++
#'
#' @param nmc number of MCMC iteration (steps).
#' @param npar number of parameter.
#' @param nchain number of chains
#' @keywords initialize_structures
#' @return a list with 7 elements: param_old, param_chain, proposal, direction,
#' LL_keep, nmc, and nchain
#' @import Rcpp
#' @export
#' @examples
#' initializeStructures(nmc=20, npar=7, nchain=3)
initializeStructures <- function(nmc, npar, nchain) {
    .Call('pda_initializeStructures', PACKAGE = 'pda', nmc, npar, nchain)
}

#' Compute Log-likelihood Using Fast Fourier Transform
#'
#' This function takes subject data, the parameters for the current chain
#' under consideration, and MCMC parameters and computes the log likelihood.
#'
#' @param data subject data
#' @param pVec a parameter vector for piece-wise LBA Model
#' @param MCMC_params MCMC parameters
#' @return Log-likelihood
#' @export
#' @examples
#' mcmcParams <- list(sigma_exact=1, bandwidth=.02, LL_NSAMPLE=1e5,
#'                   Nstep=30, Nchain=24, noise_size=.001, burnin=10,
#'                   resample_mod=3)
#' logLik_fft(mcmcParams)
#' load("data/Data1.rda")
#' dplyr::tbl_dt(d)
#'
#' ## Source: local data table [1,000 x 3]
#' ##      Response ResponseTime Block
#' ##         (dbl)        (dbl) (dbl)
#' ##   1         0    0.5676343     1
#' ##   2         1    0.6183177     1
#' ##   3         0    0.8806298     1
#' ##   4         0    0.4563023     1
#' ##   5         1    0.8496136     1
#' ##   6         0    0.5866219     1
#' ##   7         1    0.6482302     1
#' ##   8         1    0.3510035     1
#' ##   9         0    0.6117150     1
#' ##   10        0    0.6940521     1
#' ##   ..      ...          ...   ...
#' t0 <- as.vector(attr(d, "SwitchTime"))
#' C1time <- as.vector(attr(d, "C1time"))
#' C2time <- as.vector(attr(d, "C2time"))
#' attr(d, "SwitchTime") <- NULL
#' attr(d, "C1time")     <- NULL
#' attr(d, "C2time")     <- NULL
#' str(d)
#' ## 'data.frame':	1000 obs. of  3 variables:
#' ## $ Response    : num  0 1 0 0 1 0 1 1 0 0 ...
#' ## $ ResponseTime: num  0.568 0.618 0.881 0.456 0.85 ...
#' ## $ Block       : num  1 1 1 1 1 1 1 1 1 1 ...
#' dat <- list(data=d, SwitchTime=t0, C1time=C1time, C2time=C2time)
#' p.vector <- c(1.51, 3.32, 1.51, 2.24, 3.69, 0.31, 0.08)
#' tmp0 <- logLik_fft(data=dat, pVec=p.vector, MCMC_params=mcmcParams)
#' tmp1 <- dat$C2time - p.vector[7]
#' all(tmp0==tmp2)
#' [1] TRUE
logLik_fft <- function(data, pVec, MCMC_params) {
    .Call('pda_logLik_fft', PACKAGE = 'pda', data, pVec, MCMC_params)
}

#' Retrieve piecewise RTs from a pLBA Model
#'
#' Get piecewise RTs
#'
#' @param data a Rcpp List for subject data
#' @param pVec a Rcpp NumvericVector for parameter vector
#' @param MCMC_params MCMC parameters
#' @return A two-element list
#' @examples
#' load("data/Data1.rda")
#' p.vector <- c(1.51, 3.32, 1.51, 2.24, 3.69, 0.31, 0.08)
#' mcmcParams <- list(sigma_exact=1, bandwidth=.02, LL_NSAMPLE=1e2,
#'                     Nstep=30, Nchain=24, noise_size=.001, burnin=10,
#'                     resample_mod=3)
#'
#' tmp0 <- getPRT(d, p.vector, mcmcParams)
#' str(tmp0[[1]])
#' str(tmp0[[2]])
#' @export
getPRT <- function(data, pVec, MCMC_params) {
    .Call('pda_getPRT', PACKAGE = 'pda', data, pVec, MCMC_params)
}

